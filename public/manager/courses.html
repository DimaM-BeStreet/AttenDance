<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>×§×•×¨×¡×™× - ××¢×¨×›×ª × ×™×”×•×œ × ×•×›×—×•×ª</title>
  <style>
    .search-results-dropdown {
      position: absolute;
      top: 100%;
      left: 0;
      right: 0;
      background: white;
      border: 1px solid var(--border-color);
      border-radius: 8px;
      max-height: 300px;
      overflow-y: auto;
      z-index: 1000;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      margin-top: 4px;
    }
    
    .search-result-item {
      padding: 12px 16px;
      cursor: pointer;
      border-bottom: 1px solid var(--border-color);
      transition: background-color 0.2s;
    }
    
    .search-result-item:last-child {
      border-bottom: none;
    }
    
    .search-result-item:hover {
      background-color: var(--background-secondary);
    }
    
    .search-result-item-name {
      font-weight: 500;
      color: var(--text-primary);
    }
    
    .search-result-item-details {
      font-size: 13px;
      color: var(--text-secondary);
      margin-top: 4px;
    }
    
    .search-no-results {
      padding: 16px;
      text-align: center;
      color: var(--text-secondary);
    }
  </style>
</head>
<body>
  <!-- Navigation -->
  <div id="navbar-container"></div>

  <main class="page-main">
    <!-- Header -->
    <div class="page-header">
      <div class="header-content">
        <h1 class="page-title">×§×•×¨×¡×™×</h1>
        <p class="page-subtitle" id="coursesCount">×˜×•×¢×Ÿ...</p>
      </div>
      <div class="header-actions" style="display: flex; gap: 10px; align-items: center;">
        <button class="btn btn-secondary" id="importCoursesBtn">
          ğŸ“¥ ×™×‘×•×
        </button>
        <button class="btn btn-primary" id="addCourseBtn">
          + ×§×•×¨×¡ ×—×“×©
        </button>
      </div>
    </div>

    <!-- Filters -->
    <div class="filters-container">
        <div class="filter-group">
          <label for="searchCourse">×—×™×¤×•×©:</label>
          <input type="text" id="searchCourse" class="form-control" placeholder="×—×¤×© ×§×•×¨×¡...">
        </div>

        <div class="filter-group" id="branchFilterGroup" style="display: none;">
          <label for="branchFilter">×¡× ×™×£:</label>
          <select id="branchFilter" class="form-control">
            <option value="">×›×œ ×”×¡× ×™×¤×™×</option>
          </select>
        </div>
        
        <div class="filter-group filter-status-group">
          <label for="filterStatus">×¡×˜×˜×•×¡:</label>
          <select id="filterStatus" class="form-control">
            <option value="">×”×›×œ</option>
            <option value="active" selected>×¤×¢×™×œ</option>
            <option value="upcoming">×¢×ª×™×“×™</option>
            <option value="completed">×”×¡×ª×™×™×</option>
            <option value="cancelled">×‘×•×˜×œ</option>
          </select>
        </div>

        <!-- More Actions Menu (Moved here) -->
        <div class="header-actions-menu" style="margin-right: auto;">
            <button class="btn-icon" id="moreActionsBtn" title="××¤×©×¨×•×™×•×ª × ×•×¡×¤×•×ª">
                â‹®
            </button>
            <div class="actions-dropdown" id="moreActionsDropdown">
                <button class="dropdown-item" id="showProblemsBtn">
                    <span class="dropdown-item-icon">âš ï¸</span>
                    ×”×¦×’ ×§×•×¨×¡×™× ×‘×¢×™×™×ª×™×™×
                </button>
                <button class="dropdown-item" id="showAllBranchBtn">
                    <span class="dropdown-item-icon">ğŸ“‹</span>
                    ×”×¦×’ ×”×›×œ (×œ×œ× ×“×¤×“×•×£)
                </button>
                <button class="dropdown-item" id="showInactiveBtn">
                    <span class="dropdown-item-icon">ğŸš«</span>
                    ×”×¦×’ ×§×•×¨×¡×™× ×œ× ×¤×¢×™×œ×™×
                </button>
            </div>
        </div>
      </div>

      <!-- Courses List -->
      <div class="courses-container" id="coursesContainer">
        <div id="coursesList" class="courses-list">
          <!-- Courses will be dynamically inserted here -->
        </div>
        
        <div id="emptyState" class="empty-state" style="display: none;">
          <div class="empty-state-icon">ğŸ“š</div>
          <h3>××™×Ÿ ×§×•×¨×¡×™×</h3>
          <p>×”×ª×—×œ ×¢×œ ×™×“×™ ×™×¦×™×¨×ª ×§×•×¨×¡ ×¨××©×•×Ÿ</p>
          <button class="btn btn-primary" id="addCourseEmptyBtn">
            <span>+ ×¦×•×¨ ×§×•×¨×¡ ×¨××©×•×Ÿ</span>
          </button>
        </div>
      </div>
  </main>

  <!-- Add/Edit Course Modal -->
  <div id="courseModal" class="modal-content modal-lg" style="display: none;">
      <div class="modal-header">
        <h2 id="courseModalTitle">×§×•×¨×¡ ×—×“×©</h2>
        <button class="modal-close" id="closeCourseModal">&times;</button>
      </div>
      <form id="courseForm">
        <div class="modal-body">
          <div class="form-row">
            <div class="form-group">
              <label for="courseName">×©× ×”×§×•×¨×¡ *</label>
              <input type="text" id="courseName" class="form-control" required>
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label for="courseStartDate">×ª××¨×™×š ×”×ª×—×œ×” *</label>
              <input type="text" id="courseStartDate" class="form-control" placeholder="dd/mm/yyyy" pattern="\d{2}/\d{2}/\d{4}" required>
            </div>

            <div class="form-group">
              <label for="courseEndDate">×ª××¨×™×š ×¡×™×•× *</label>
              <input type="text" id="courseEndDate" class="form-control" placeholder="dd/mm/yyyy" pattern="\d{2}/\d{2}/\d{4}" required>
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label for="coursePrice">××—×™×¨ (â‚ª)</label>
              <input type="number" id="coursePrice" class="form-control" min="0" step="0.01" value="0">
            </div>

            <div class="form-group">
              <label for="courseMaxStudents">××§×¡×™××•× ×ª×œ××™×“×™×</label>
              <input type="number" id="courseMaxStudents" class="form-control" min="1" placeholder="×œ×œ× ×”×’×‘×œ×”">
            </div>
          </div>

          <div class="form-group">
            <label for="courseDescription">×ª×™××•×¨</label>
            <textarea id="courseDescription" class="form-control" rows="3"></textarea>
          </div>

          <div class="form-group">
            <label>×ª×‘× ×™×•×ª ×©×™×¢×•×¨×™× ×‘×§×•×¨×¡ *</label>
            <div class="template-search-container" style="margin-bottom: 10px;">
                <input type="text" id="templateSearchInput" class="form-control" placeholder="×—×¤×© ×ª×‘× ×™×ª ×©×™×¢×•×¨..." autocomplete="off">
            </div>
            <div id="templatesSelection" class="templates-selection">
              <!-- Templates checkboxes will be inserted here -->
            </div>
            <small class="form-text">×‘×—×¨ ××ª ×”×©×™×¢×•×¨×™× ×”×§×‘×•×¢×™× ×©×”×§×•×¨×¡ ×›×•×œ×œ</small>
          </div>
        </div>
        
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" id="cancelCourseBtn">×‘×™×˜×•×œ</button>
          <button type="submit" class="btn btn-primary" id="saveCourseBtn">×©××•×¨ ×§×•×¨×¡</button>
          <button type="button" class="btn btn-danger" id="cancelCourseStatusBtn" style="display: none;">×‘×˜×œ ×§×•×¨×¡</button>
        </div>
      </form>
  </div>

  <!-- Manage Enrollments Modal -->
  <div id="enrollmentsModal" class="modal-content modal-lg" style="display: none;">
      <div class="modal-header">
        <h2 id="enrollmentsModalTitle">× ×™×”×•×œ ×¨×™×©×•× - <span id="enrollmentCourseName"></span></h2>
        <button class="modal-close" id="closeEnrollmentsModal">&times;</button>
      </div>
      
      <div class="modal-body">
        <!-- Add Student Toggle Button -->
        <div style="margin-bottom: 20px;">
          <button type="button" class="btn btn-primary" id="showAddStudentBtn">
            + ×¨×©×•× ×ª×œ××™×“ ×—×“×©
          </button>
        </div>

        <!-- Add Student Section -->
        <div class="add-student-section" id="addStudentSection" style="display: none; background-color: var(--background-secondary); padding: 16px; border-radius: 8px; margin-bottom: 24px;">
          <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
            <h3 style="margin: 0; font-size: 1.1rem;">×¨×©×•× ×ª×œ××™×“</h3>
          </div>
          
          <div class="form-row" style="display: flex; gap: 12px; align-items: flex-end;">
            <div class="form-group" style="position: relative; flex: 1;">
              <label for="enrollStudentSearch" style="margin-bottom: 4px; display: block;">×—×¤×© ×ª×œ××™×“</label>
              <input 
                type="text" 
                id="enrollStudentSearch" 
                class="form-control" 
                placeholder="×”×§×œ×“ ×©× ××• ×˜×œ×¤×•×Ÿ..."
                autocomplete="off"
                style="width: 100%;"
              >
              <input type="hidden" id="enrollStudentId">
              <div id="studentSearchResults" class="search-results-dropdown" style="display: none;">
                <!-- Search results will appear here -->
              </div>
            </div>
            
            <div class="form-group" style="width: 130px; flex-shrink: 0;">
              <label for="enrollEffectiveFrom" style="margin-bottom: 4px; display: block;">×ª××¨×™×š ×”×ª×—×œ×”</label>
              <input type="text" id="enrollEffectiveFrom" class="form-control" placeholder="dd/mm/yyyy" pattern="\d{2}/\d{2}/\d{4}" style="width: 100%;">
            </div>
          </div>
          
          <div class="form-row" style="margin-top: 16px; display: flex; justify-content: flex-start; gap: 10px;">
            <button type="button" class="btn btn-primary" id="addEnrollmentBtn" style="min-width: 120px;">×¨×©×•×</button>
            <button type="button" class="btn btn-secondary" id="hideAddStudentBtn">×‘×™×˜×•×œ</button>
          </div>
        </div>

        <!-- Enrolled Students List -->
        <div class="enrolled-students-section">
          <h3>×ª×œ××™×“×™× ×¨×©×•××™× (<span id="enrolledCount">0</span>)</h3>
          <div id="enrolledStudentsList" class="enrolled-students-list">
            <!-- Enrolled students will be inserted here -->
          </div>
        </div>
      </div>
      
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" id="closeEnrollmentsBtn">×¡×’×•×¨</button>
      </div>
  </div>

  <!-- Course Details Modal -->
  <div id="courseDetailsModal" class="modal-content modal-lg" style="display: none;">
      <div class="modal-header">
        <h2 id="courseDetailsTitle"></h2>
        <button class="modal-close" id="closeCourseDetailsModal">&times;</button>
      </div>
      
      <div class="modal-body">
        <div id="courseDetailsContent">
          <!-- Course details will be inserted here -->
        </div>
      </div>
      
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" id="closeCourseDetailsBtn">×¡×’×•×¨</button>
        <button type="button" class="btn btn-primary" id="editCourseDetailsBtn">×¢×¨×•×š ×§×•×¨×¡</button>
      </div>
  </div>

  <script src="../js/manager/courses.bundle.js"></script>
</body>
</html>
